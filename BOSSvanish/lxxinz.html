<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>与文心竹的对话</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #0a0a0a;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(100, 0, 0, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(100, 0, 0, 0.1) 0%, transparent 20%);
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        header {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid #600;
            background-color: rgba(20, 0, 0, 0.7);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.1);
        }
        
        h1 {
            color: #ff3333;
            font-size: 2.2rem;
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 50, 50, 0.3);
            letter-spacing: 1px;
        }
        
        .subtitle {
            color: #aaa;
            font-size: 1rem;
            letter-spacing: 3px;
            text-transform: uppercase;
        }
        
        .chat-container {
            background-color: rgba(15, 0, 0, 0.85);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        
        .chat-header {
            background: linear-gradient(to right, #200000, #400000);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #600;
        }
        
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff3333, #800000);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            border: 2px solid #ff6666;
            box-shadow: 0 0 10px rgba(255, 50, 50, 0.5);
        }
        
        .my-avatar {
            background: linear-gradient(135deg, #333333, #1a1a1a);
            border: 2px solid #666;
        }
        
        .avatar i {
            font-size: 24px;
            color: #fff;
        }
        
        .user-info h2 {
            color: #ff6666;
            font-size: 1.4rem;
        }
        
        .my-user-info h2 {
            color: #ccc;
        }
        
        .user-info p {
            color: #ccc;
            font-size: 0.9rem;
            margin-top: 3px;
        }
        
        .status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ff3333;
            margin-left: 10px;
            box-shadow: 0 0 10px #ff3333;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: rgba(10, 0, 0, 0.9);
        }
        
        .message {
            display: flex;
            max-width: 80%;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.received {
            align-self: flex-start;
        }
        
        .message.sent {
            align-self: flex-end;
        }
        
        .message-content {
            padding: 15px 20px;
            border-radius: 20px;
            position: relative;
            line-height: 1.5;
            font-size: 1.05rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            max-width: 100%;
            word-wrap: break-word;
        }
        
        .received .message-content {
            background: linear-gradient(135deg, #300000, #500000);
            border: 1px solid #600;
            color: #f0f0f0;
            border-bottom-left-radius: 5px;
        }
        
        .sent .message-content {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            border: 1px solid #444;
            color: #ddd;
            border-bottom-right-radius: 5px;
        }
        
        .message-time {
            font-size: 0.75rem;
            color: #888;
            margin-top: 5px;
            text-align: right;
        }
        
        .received .message-time {
            text-align: left;
        }
        
        .code-message {
            background-color: rgba(0, 0, 0, 0.5) !important;
            border: 1px solid #ff3333 !important;
            font-family: monospace;
            font-size: 1.3rem;
            letter-spacing: 3px;
            text-align: center;
            padding: 20px;
            margin-top: 10px;
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 50, 50, 0.5); }
            50% { box-shadow: 0 0 15px rgba(255, 50, 50, 0.8); }
        }
        
        .chat-footer {
            padding: 20px;
            border-top: 1px solid #333;
            background-color: rgba(20, 0, 0, 0.9);
            display: flex;
            align-items: center;
        }
        
        .input-container {
            flex: 1;
            display: flex;
            background-color: rgba(40, 0, 0, 0.7);
            border-radius: 30px;
            border: 1px solid #600;
            overflow: hidden;
            padding: 5px;
        }
        
        input {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 20px;
            color: #eee;
            font-size: 1rem;
            outline: none;
        }
        
        button {
            background: linear-gradient(to right, #ff3333, #800000);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            letter-spacing: 1px;
            transition: all 0.3s;
            margin-left: 10px;
        }
        
        button:hover {
            background: linear-gradient(to right, #ff5555, #a00000);
            box-shadow: 0 0 15px rgba(255, 50, 50, 0.5);
        }
        
        button:disabled {
            background: #444;
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .encryption-notice {
            text-align: center;
            color: #888;
            font-size: 0.85rem;
            padding: 10px;
            border-top: 1px solid #222;
            background-color: rgba(10, 0, 0, 0.8);
        }
        
        .encryption-notice i {
            color: #ff3333;
            margin-right: 5px;
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 0, 0, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: #600;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #800;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background-color: rgba(50, 0, 0, 0.7);
            border-radius: 20px;
            width: fit-content;
            margin-top: 10px;
            border: 1px solid #600;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: #ff6666;
            border-radius: 50%;
            margin: 0 3px;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 10px;
            flex-shrink: 0;
        }
        
        .received .message-avatar {
            background: linear-gradient(135deg, #ff3333, #800000);
            border: 1px solid #ff6666;
        }
        
        .sent .message-avatar {
            background: linear-gradient(135deg, #333333, #1a1a1a);
            border: 1px solid #666;
        }
        
        .message-avatar i {
            font-size: 16px;
            color: #fff;
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .chat-container {
                height: 500px;
                border-radius: 8px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
                letter-spacing: 2px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .message-content {
                padding: 12px 16px;
                font-size: 1rem;
            }
            
            .chat-messages {
                padding: 15px;
                gap: 15px;
            }
            
            .message-avatar {
                width: 30px;
                height: 30px;
                margin: 0 8px;
            }
            
            .message-avatar i {
                font-size: 14px;
            }
            
            .code-message {
                font-size: 1.1rem;
                padding: 15px;
            }
            
            .chat-header {
                padding: 12px 15px;
            }
            
            .avatar {
                width: 40px;
                height: 40px;
                margin-right: 10px;
            }
            
            .avatar i {
                font-size: 20px;
            }
            
            .user-info h2 {
                font-size: 1.2rem;
            }
            
            .chat-footer {
                padding: 15px;
            }
            
            input {
                padding: 10px 15px;
            }
            
            button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .encryption-notice {
                font-size: 0.75rem;
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .message {
                max-width: 95%;
            }
            
            .message-content {
                padding: 10px 14px;
                font-size: 0.95rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .message-avatar {
                width: 28px;
                height: 28px;
                margin: 0 6px;
            }
            
            .code-message {
                font-size: 1rem;
                padding: 12px;
            }
        }
    </style>
    <link rel="stylesheet" href="sc-style.css">
    <link rel="icon" type="image/png" href="dtma.png">
</head>
<body>
    <div class="container">
        <header>
            <h1><!-- <i class="fas fa-user-secret"></i>  -->与文心竹的对话</h1>
            <p class="subtitle">加密通信 · 实时对话 · 端到端保护</p>
        </header>
        
        <div class="chat-container">
            <div class="chat-header">
                <div class="avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-info">
                    <h2>文心竹 <span class="status"></span></h2>
                    <p>在线 · 加密状态: <i class="fas fa-lock"></i> 已启用</p>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <!-- 对话内容将通过JavaScript动态添加 -->
            </div>
            
            <div class="chat-footer">
                <div class="input-container">
                    <input type="text" id="messageInput" placeholder="输入消息... (按Enter发送)" autocomplete="off">
                </div>
                <button id="sendButton"><i class="fas fa-paper-plane"></i> 发送</button>
            </div>
            
            <div class="encryption-notice">
                <i class="fas fa-shield-alt"></i> 此对话已使用端到端加密保护。连接将在24小时后自动销毁。
            </div>
        </div>
    </div>
<!-- 搜索球容器 -->
<div class="floating-search-ball-container">
    <!-- 搜索球（点击展开） -->
    <div class="floating-search-ball" id="searchBall" aria-label="打开搜索"></div>
    
    <!-- 展开的搜索框 -->
    <div class="floating-search-expanded" id="searchExpanded">
        <input type="text" 
               class="floating-search-input" 
               id="searchInput" 
               placeholder="输入关键词搜索..." 
               aria-label="搜索输入框">
        <button class="floating-search-close" id="searchClose" aria-label="关闭搜索">×</button>
        <button class="floating-search-submit" id="searchSubmit" aria-label="执行搜索">搜索</button>
    </div>
</div>
    <script>
        // 对话数据 - 初始对话内容
        let messages = [
            {
                sender: "sent",
                text: "心竹姐，我需要你的帮助。",
                time: "21:02",
                avatar: "我"
            },
            { 
                avatar: "文",
                sender: "received",
                text: "陈沐？",
                time: "21:03"
            },
            {
                sender: "sent",
                text: "是的，是我！",
                time: "21:03",
                avatar: "我"
            },
            {
                sender: "received",
                text: "你是店里的常客了，也难怪你知道后台密码",
                time: "21:03",
                avatar: "文"
            },
            {
                sender: "received",
                text: "你找我是为了什么？",
                time: "21:03",
                avatar: "文"
            },
            {
                sender: "sent",
                text: "我想知道你丈夫是不是曾问你要某种药品...",
                time: "21:03",
                avatar: "我"
            },
            {
                sender: "sent",
                text: "我知道这很突然，但我现在处境很危险。",
                time: "21:03",
                avatar: "我"
            },
            {
                sender: "received",
                text: "我为什么要帮你？",
                time: "21:04",
                avatar: "文"
            },
            {
                sender: "sent",
                text: "因为只有你能帮我了。现在没有一个人肯相信我，心竹姐，你知道我不可能做那种事的。",
                time: "21:04",
                avatar: "我"
            },
            {
                sender: "received",
                text: "他是我的丈夫，你凭什么觉得我会帮你？",
                time: "21:05",
                avatar: "文"
            },
            {
                sender: "sent",
                text: "我知道这很难，但你也知道他做了什么。我不是在求你背叛他，也不是求你帮我，只是你真的忍心看他走错路吗？",
                time: "21:06",
                avatar: "我"
            }
        ];
        
        // 获取DOM元素
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const statusIndicator = document.querySelector('.status');
        
        // 文心竹可能的回复
        const wenResponses = [
            "......",
            "我明白了",
            "你让我怎么相信你？",
            "这太危险了",
            "我需要时间考虑",
            "你知道这对我意味着什么吗？",
            "我不想背叛我的丈夫",
            "告诉我更多细节",
            "你有什么计划？",
            "这不可能",
            "我为什么要冒这个险？",
            
        ];
        /* "你当初离开的时候，想过今天吗？" */
        // 消息计数器 - 用于控制连接码出现时机
        let messageCounter = messages.length;
        let connectionCodeSent = false;
        
        // 获取当前时间格式
        function getCurrentTime() {
            const now = new Date();
            return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
        }
        
        // 添加消息到聊天界面
        function addMessage(sender, text, avatar, isCode = false) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            
            const avatarElement = sender === 'received' ? 
                `<div class="message-avatar"><i class="fas fa-user"></i></div>` : 
                `<div class="message-avatar"><i class="fas fa-user"></i></div>`;
            
            // 修复头像位置：左边消息(接收) = 头像 + 内容，右边消息(发送) = 内容 + 头像
            if (isCode) {
                messageElement.innerHTML = sender === 'received' ? 
                    `${avatarElement}
                    <div class="message-content code-message">
                        <div>${text}</div>
                        <div class="message-time">${getCurrentTime()}</div>
                    </div>` :
                    `<div class="message-content code-message">
                        <div>${text}</div>
                        <div class="message-time">${getCurrentTime()}</div>
                    </div>
                    ${avatarElement}`;
            } else {
                messageElement.innerHTML = sender === 'received' ? 
                    `${avatarElement}
                    <div class="message-content">
                        <div>${text}</div>
                        <div class="message-time">${getCurrentTime()}</div>
                    </div>` :
                    `<div class="message-content">
                        <div>${text}</div>
                        <div class="message-time">${getCurrentTime()}</div>
                    </div>
                    ${avatarElement}`;
            }
            
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // 添加到消息历史
            messages.push({
                sender,
                text,
                time: getCurrentTime(),
                avatar
            });
            
            // 增加消息计数器
            if (sender === 'sent') {
                messageCounter++;
            }
        }
        
        // 模拟文心竹的回复
        function simulateWenResponse() {
            // 如果已经发送过连接码，就不再发送任何回复
            if (connectionCodeSent) return;
            
            // 根据最后一条消息的内容选择回复
            const lastMessage = messages[messages.length - 1];
            let response;
            
            // 记录上一次的回复，避免重复
            let lastResponse = messages.length > 1 ? messages[messages.length - 2]?.text : "";
            
            // 根据用户的消息内容选择上下文相关的回复
            if (lastMessage.sender === 'sent') {
                if (lastMessage.text.includes("解释") || lastMessage.text.includes("真相")) {
                    response = "你说吧，我听着";
                } else if (lastMessage.text.includes("危险") || lastMessage.text.includes("安全")) {
                    response = "我这里也不安全，他知道我会心软";
                } else if (lastMessage.text.includes("证据") || lastMessage.text.includes("证明")) {
                    response = "你有证据吗？没有证据说什么都没用";
                } else if (lastMessage.text.includes("信任") || lastMessage.text.includes("相信")) {
                    response = "你让我怎么相信你？";
                } else if (lastMessage.text.includes("计划") || lastMessage.text.includes("安排")) {
                    response = "告诉我你的计划，每一个细节";
                } else if (lastMessage.text.includes("对不起") || lastMessage.text.includes("抱歉")) {
                    response = "现在说这些太晚了，但...我还是想听你说完";
                } else {
                    // 随机选择一个回复，避免与上一次相同
                    let availableResponses = wenResponses.filter(res => res !== lastResponse);
                    if (availableResponses.length === 0) {
                        availableResponses = wenResponses; // 如果所有回复都用过了，重新使用所有回复
                    }
                    response = availableResponses[Math.floor(Math.random() * availableResponses.length)];
                }
                
                // 添加"正在输入"效果
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'typing-indicator';
                typingIndicator.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatMessages.appendChild(typingIndicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // 延迟发送回复
                setTimeout(() => {
                    typingIndicator.remove();
                    addMessage('received', response, '文');
                    
                    // 检查是否需要发送连接码（基于消息计数器）
                    checkForConnectionCode();
                    
                }, 1000 + Math.random() * 2000);
            }
        }
        
        // 检查是否需要发送连接码
        function checkForConnectionCode() {
            // 只有当消息总数达到一定数量，并且还没有发送过连接码时才发送
            if (messageCounter >= 14 && !connectionCodeSent && Math.random() > 0.3) {
                // 添加"正在输入"效果
                const typingIndicator = document.createElement('div');
                typingIndicator.className = 'typing-indicator';
                typingIndicator.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatMessages.appendChild(typingIndicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                setTimeout(() => {
                    typingIndicator.remove();
                    addMessage('received', '连接码是641565', '文', true);
                    updateStatus('已连接');
                    connectionCodeSent = true;
                }, 2000);
            }
        }
        
        // 更新状态指示器
        function updateStatus(status) {
            if (status === '在线') {
                statusIndicator.style.animation = 'pulse 2s infinite';
                statusIndicator.style.backgroundColor = '#ff3333';
                statusIndicator.style.boxShadow = '0 0 10px #ff3333';
            } else if (status === '已连接') {
                statusIndicator.style.animation = 'none';
                statusIndicator.style.backgroundColor = '#00cc00';
                statusIndicator.style.boxShadow = '0 0 10px #00cc00';
            } else if (status === '离线') {
                statusIndicator.style.animation = 'none';
                statusIndicator.style.backgroundColor = '#888';
                statusIndicator.style.boxShadow = '0 0 5px #888';
            }
        }
        
        // 发送消息
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text) return;
            
            // 添加用户消息
            addMessage('sent', text, '我');
            
            // 清空输入框
            messageInput.value = '';
            
            // 模拟文心竹回复
            simulateWenResponse();
        }
        
        // 渲染初始消息
        function renderInitialMessages() {
            chatMessages.innerHTML = '';
            
            // 添加系统消息
            const systemMessage = document.createElement('div');
            systemMessage.className = 'message received';
            systemMessage.innerHTML = `
                <div class="message-avatar"><i class="fas fa-shield-alt"></i></div>
                <div class="message-content">
                    <div>加密会话已建立。所有消息均受端到端加密保护。</div>
                    <div class="message-time">${getCurrentTime()}</div>
                </div>
            `;
            chatMessages.appendChild(systemMessage);
            
            // 渲染历史消息
            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${message.sender}`;
                
                const avatarElement = message.sender === 'received' ? 
                    `<div class="message-avatar"><i class="fas fa-user"></i></div>` : 
                    `<div class="message-avatar"><i class="fas fa-user"></i></div>`;
                
                const isCode = message.text.includes("连接码");
                
                // 修复头像位置：左边消息(接收) = 头像 + 内容，右边消息(发送) = 内容 + 头像
                if (isCode) {
                    messageElement.innerHTML = message.sender === 'received' ? 
                        `${avatarElement}
                        <div class="message-content code-message">
                            <div>${message.text}</div>
                            <div class="message-time">${message.time}</div>
                        </div>` :
                        `<div class="message-content code-message">
                            <div>${message.text}</div>
                            <div class="message-time">${message.time}</div>
                        </div>
                        ${avatarElement}`;
                } else {
                    messageElement.innerHTML = message.sender === 'received' ? 
                        `${avatarElement}
                        <div class="message-content">
                            <div>${message.text}</div>
                            <div class="message-time">${message.time}</div>
                        </div>` :
                        `<div class="message-content">
                            <div>${message.text}</div>
                            <div class="message-time">${message.time}</div>
                        </div>
                        ${avatarElement}`;
                }
                
                chatMessages.appendChild(messageElement);
            });
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderInitialMessages();
            updateStatus('在线');
            
            // 发送按钮点击事件
            sendButton.addEventListener('click', sendMessage);
            
            // 输入框回车键事件
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // 输入框获取焦点时启用发送按钮
            messageInput.addEventListener('input', () => {
                sendButton.disabled = messageInput.value.trim() === '';
            });
            
            // 初始禁用发送按钮
            sendButton.disabled = true;
        });
        
        // 添加一些视觉特效
        document.addEventListener('mousemove', (e) => {
            const x = e.clientX / window.innerWidth;
            const y = e.clientY / window.innerHeight;
            
            document.body.style.backgroundPosition = `${x * 100}% ${y * 100}%`;
        });
    </script>
 <script src="pages.js"></script>
<script src="scball.js"></script>
<script src="visit.js"></script>
</body>
</html>