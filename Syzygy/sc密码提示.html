<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/jpeg" href="https://sylvie-seven-cq.top/gallery/search.png">
    <title>å¯†ç æç¤º - æœç´¢ç»“æœ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: white;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 80%;
            margin: 0 auto;
            padding-top: 30px;
        }

        .logo {
            display: block;
            margin: 0 auto 20px;
            width: 150px;
            height: 150px;
        }

        .search-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .search-box {
            width: 500px;
            padding: 12px 20px;
            font-size: 16px;
            border: 1px solid #dfe1e5;
            border-radius: 24px;
            outline: none;
            box-shadow: 0 1px 6px rgba(32, 33, 36, 0.28);
        }

            .search-box:focus {
                box-shadow: 0 1px 6px rgba(32, 33, 36, 0.45);
            }

        .search-button {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }

        h1 {
            text-align: center;
            font-size: 36px;
            margin-bottom: 20px;
        }

        .news-list {
            list-style-type: none;
            padding-left: 0;
        }

        .news-item {
            border-bottom: 1px solid #ddd;
            padding: 15px 0;
        }

            .news-item .title {
                font-size: 18px;
                font-weight: bold;
                color: #1a0dab;
                text-decoration: none;
            }

                .news-item .title:hover {
                    text-decoration: underline;
                }

            .news-item .source {
                font-size: 14px;
                color: #6a6a6a;
            }

            .news-item .date {
                font-size: 12px;
                color: #777;
            }

        .related-searches {
            margin-top: 40px;
        }

            .related-searches h2 {
                font-size: 24px;
                margin-bottom: 10px;
            }

            .related-searches ul {
                list-style-type: none;
                padding-left: 0;
            }

                .related-searches ul li {
                    font-size: 16px;
                    margin-bottom: 5px;
                }

                    .related-searches ul li a {
                        color: #1a0dab;
                        text-decoration: none;
                    }

                        .related-searches ul li a:hover {
                            text-decoration: underline;
                        }

        .search-suggestions {
            position: absolute;
            background: white;
            border: 1px solid #dfe1e5;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            width: 500px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

            .search-suggestions div {
                padding: 10px 15px;
                cursor: pointer;
            }

                .search-suggestions div:hover {
                    background-color: #f5f5f5;
                }

        .suggestion-container {
            position: relative;
            display: inline-block;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="https://sylvie-seven-cq.top/gallery/search.png" alt="Logo" class="logo">
        <div class="search-container">
            <div class="suggestion-container">
                <input type="text" class="search-box" id="searchInput" placeholder="æœç´¢å…¶ä»–å…³é”®è¯..." value="å¯†ç æç¤º">
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            <button class="search-button" id="searchButton">æœç´¢</button>
        </div>
        <h1 id="pageTitle">å¯†ç æç¤º - æœç´¢ç»“æœåˆ—è¡¨</h1>
        <div id="loadingIndicator" class="loading" style="display: none;">åŠ è½½ä¸­...</div>
        <ul class="news-list" id="resultsList">
            <!-- æœç´¢ç»“æœå°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </ul>

        <div class="related-searches">
            <h2>çŒœä½ æƒ³æœ</h2>
            <ul id="relatedSearchesList">
                <!-- ç›¸å…³æœç´¢å°†åŠ¨æ€ç”Ÿæˆ -->
            </ul>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡æ¥å­˜å‚¨å…³é”®è¯æ˜ å°„
        let keywordRedirects = {};
        let decodedKeywords = {}; // å­˜å‚¨è§£ç åçš„å…³é”®è¯æ˜ å°„

        // ç¼–ç è§£ç å‡½æ•°
        function encodeKeyword(keyword) {
            return btoa(unescape(encodeURIComponent(keyword)));
        }

        function decodeKeyword(encodedKeyword) {
            try {
                return decodeURIComponent(escape(atob(encodedKeyword)));
            } catch (e) {
                console.error('è§£ç å¤±è´¥:', encodedKeyword, e);
                return encodedKeyword;
            }
        }

        // ä»JSONæ–‡ä»¶åŠ è½½å…³é”®è¯æ˜ å°„å¹¶è§£ç 
        async function loadKeywordRedirects() {
            try {
                console.log('å¼€å§‹åŠ è½½å…³é”®è¯æ˜ å°„...');
                document.getElementById('loadingIndicator').style.display = 'block';

                const response = await fetch('js/bugeikandejson.json?v=' + Date.now());
                if (!response.ok) {
                    const response = await fetch('js/bugeikandejson.json?v=' + Date.now());
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                console.log('âœ… å…³é”®è¯æ˜ å°„åŠ è½½æˆåŠŸ:', Object.keys(data).length, 'ä¸ªå…³é”®è¯');

                // è§£ç æ‰€æœ‰å…³é”®è¯å¹¶å»ºç«‹æ˜ å°„
                Object.keys(data).forEach(encodedKey => {
                    const decodedKey = decodeKeyword(encodedKey);
                    decodedKeywords[decodedKey] = data[encodedKey]; // è§£ç å…³é”®è¯ -> URL
                    keywordRedirects[encodedKey] = data[encodedKey]; // ç¼–ç å…³é”®è¯ -> URL
                    console.log(`   "${decodedKey}" -> ${data[encodedKey]}`);
                });

                console.log('æ€»å…±è§£ç äº†', Object.keys(decodedKeywords).length, 'ä¸ªå…³é”®è¯');
                document.getElementById('loadingIndicator').style.display = 'none';
                return { encoded: data, decoded: decodedKeywords };
            } catch (error) {
                console.error('âŒ åŠ è½½å…³é”®è¯æ˜ å°„å¤±è´¥:', error);
                document.getElementById('loadingIndicator').style.display = 'none';
                return { encoded: {}, decoded: {} };
            }
        }

        // æ£€æŸ¥å…³é”®è¯æ˜ å°„
        function checkKeywordRedirect(query) {
            if (!keywordRedirects || Object.keys(keywordRedirects).length === 0) {
                console.log('âš ï¸ å…³é”®è¯æ˜ å°„æœªåŠ è½½');
                return false;
            }

            const encodedQuery = encodeKeyword(query);
            console.log(`ğŸ” æœç´¢æ£€æŸ¥: "${query}" -> ç¼–ç : "${encodedQuery}"`);

            // é¦–å…ˆæ£€æŸ¥ç¼–ç åçš„å…³é”®è¯
            if (keywordRedirects[encodedQuery]) {
                console.log('ğŸ¯ æ‰¾åˆ°åŒ¹é…! è·³è½¬åˆ°:', keywordRedirects[encodedQuery]);
                // ç«‹å³è·³è½¬
                setTimeout(() => {
                    window.location.href = keywordRedirects[encodedQuery];
                }, 100);
                return true;
            }

            // ç„¶åæ£€æŸ¥è§£ç åçš„å…³é”®è¯ï¼ˆå…¼å®¹æ€§æ£€æŸ¥ï¼‰
            if (decodedKeywords[query]) {
                console.log('ğŸ¯ æ‰¾åˆ°è§£ç ååŒ¹é…! è·³è½¬åˆ°:', decodedKeywords[query]);
                setTimeout(() => {
                    window.location.href = decodedKeywords[query];
                }, 100);
                return true;
            }

            console.log('âŒ æœªæ‰¾åˆ°å…³é”®è¯æ˜ å°„');
            return false;
        }

        // æœç´¢å»ºè®®åŠŸèƒ½
        function showSearchSuggestions(query) {
            const suggestionsContainer = document.getElementById('searchSuggestions');
            suggestionsContainer.innerHTML = '';

            if (!query.trim()) {
                suggestionsContainer.style.display = 'none';
                return;
            }

            // æŸ¥æ‰¾åŒ¹é…çš„å…³é”®è¯
            const matchingKeywords = Object.keys(decodedKeywords).filter(keyword =>
                keyword.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 8); // é™åˆ¶æ˜¾ç¤º8ä¸ªå»ºè®®

            if (matchingKeywords.length > 0) {
                matchingKeywords.forEach(keyword => {
                    const suggestionDiv = document.createElement('div');
                    suggestionDiv.textContent = keyword;
                    suggestionDiv.addEventListener('click', () => {
                        document.getElementById('searchInput').value = keyword;
                        suggestionsContainer.style.display = 'none';
                        performSearch(keyword);
                    });
                    suggestionsContainer.appendChild(suggestionDiv);
                });
                suggestionsContainer.style.display = 'block';
            } else {
                suggestionsContainer.style.display = 'none';
            }
        }

        // æ¨¡æ‹Ÿæœç´¢ç»“æœæ•°æ®
        const searchResults = {
            "å¯†ç æç¤º": [
                {
                    title: "å¦‚ä½•åˆ›å»ºå®‰å…¨çš„å¯†ç æç¤º",
                    source: "ç½‘ç»œå®‰å…¨æŒ‡å—",
                    date: "2023-10-15",
                    url: "#"
                },
                {
                    title: "å¯†ç æç¤ºçš„æœ€ä½³å®è·µ",
                    source: "ä¿¡æ¯å®‰å…¨æ‚å¿—",
                    date: "2023-09-22",
                    url: "#"
                },
                {
                    title: "å¿˜è®°å¯†ç æ—¶çš„æç¤ºç­–ç•¥",
                    source: "æŠ€æœ¯åšå®¢",
                    date: "2023-08-05",
                    url: "#"
                }
            ],
            "å’–å•¡åº—åå°å¯†ç ": [
                {
                    title: "å’–å•¡åº—ç®¡ç†ç³»ç»Ÿå¯†ç é‡ç½®æŒ‡å—",
                    source: "å’–å•¡åº—ç®¡ç†æ‰‹å†Œ",
                    date: "2023-11-10",
                    url: "#"
                },
                {
                    title: "å¦‚ä½•ä¿æŠ¤å’–å•¡åº—åå°ç³»ç»Ÿ",
                    source: "é¤é¥®å®‰å…¨",
                    date: "2023-10-28",
                    url: "#"
                }
            ],
            "è¶…å¸‚åå°å¯†ç ": [
                
                {
                    title: "è¶…å¸‚åº“å­˜ç®¡ç†ç³»ç»Ÿå®‰å…¨æŒ‡å—",
                    source: "é›¶å”®å®‰å…¨",
                    date: "2023-09-18",
                    url: "#"
                }
            ],
            "å®éªŒå®¤å¯†ç ": [
                {
                    title: "å®éªŒå®¤è®¾å¤‡å¯†ç ä¿æŠ¤ç­–ç•¥",
                    source: "å®éªŒå®¤ç®¡ç†",
                    date: "2023-10-30",
                    url: "#"
                },
                {
                    title: "ç§‘ç ”æ•°æ®å®‰å…¨ä¸å¯†ç ç®¡ç†",
                    source: "ç§‘ç ”å®‰å…¨",
                    date: "2023-09-12",
                    url: "#"
                }
            ]
        };

        // æ‰§è¡Œæ™®é€šæœç´¢åŠŸèƒ½
        function performNormalSearch(query) {
            console.log('ğŸ” æ‰§è¡Œæ™®é€šæœç´¢:', query);

            // æ¸…ç©ºä¹‹å‰çš„æœç´¢ç»“æœ
            resultsList.innerHTML = '';

            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.title = `${query} - æœç´¢ç»“æœ`;
            if (pageTitle) {
                pageTitle.textContent = `${query} - æœç´¢ç»“æœåˆ—è¡¨`;
            }

            // è·å–æœç´¢ç»“æœ
            const results = searchResults[query] || [];

            if (results.length === 0) {
                // æ²¡æœ‰æœç´¢ç»“æœ
                const noResultsItem = document.createElement('li');
                noResultsItem.className = 'news-item';
                noResultsItem.innerHTML = `
                        <div class="title">æœç´¢: ${query}</div>
                        <div class="source">æš‚æ— æœç´¢ç»“æœï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯</div>
                    `;
                resultsList.appendChild(noResultsItem);
            } else {
                // æ˜¾ç¤ºæœç´¢ç»“æœ
                results.forEach(result => {
                    const resultItem = document.createElement('li');
                    resultItem.className = 'news-item';
                    resultItem.innerHTML = `
                            <a href="${result.url}" class="title">${result.title}</a>
                            <div class="source">${result.source}</div>
                            <div class="date">${result.date}</div>
                        `;
                    resultsList.appendChild(resultItem);
                });
            }
        }

        // ç”Ÿæˆç›¸å…³æœç´¢
        function generateRelatedSearches() {
            const relatedList = document.getElementById('relatedSearchesList');
            relatedList.innerHTML = '';

            // å–å‰å‡ ä¸ªè§£ç åçš„å…³é”®è¯ä½œä¸ºç›¸å…³æœç´¢
            const relatedKeywords = Object.keys(decodedKeywords).slice(0, 6);

            relatedKeywords.forEach(keyword => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = '#';
                a.className = 'related-search';
                a.textContent = keyword;
                a.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.getElementById('searchInput').value = keyword;
                    performSearch(keyword);
                });
                li.appendChild(a);
                relatedList.appendChild(li);
            });
        }

        // ä¸»æœç´¢å‡½æ•°
        function performSearch(query) {
            console.log('ğŸš€ å¼€å§‹æœç´¢:', query);

            // é¦–å…ˆæ£€æŸ¥å…³é”®è¯æ˜ å°„
            if (checkKeywordRedirect(query)) {
                console.log('âœ… å…³é”®è¯æ˜ å°„åŒ¹é…ï¼Œå‡†å¤‡è·³è½¬');
                return; // å¦‚æœæ‰¾åˆ°æ˜ å°„ï¼Œç›´æ¥è¿”å›ï¼Œä¸æ‰§è¡Œæ™®é€šæœç´¢
            }

            // å¦‚æœæ²¡æœ‰é‡å®šå‘ï¼Œæ‰§è¡Œæ™®é€šæœç´¢
            console.log('ğŸ“ æ‰§è¡Œæ™®é€šæœç´¢é€»è¾‘');
            performNormalSearch(query);
        }

        // è·å–DOMå…ƒç´ 
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const resultsList = document.getElementById('resultsList');
        const pageTitle = document.getElementById('pageTitle');
        const searchSuggestions = document.getElementById('searchSuggestions');

        // åˆå§‹åŒ–æœç´¢åŠŸèƒ½
        async function initSearch() {
            console.log('ğŸ”§ åˆå§‹åŒ–æœç´¢åŠŸèƒ½...');

            // åŠ è½½å…³é”®è¯æ˜ å°„
            await loadKeywordRedirects();

            // åˆå§‹åŒ–é¡µé¢æ—¶æ‰§è¡Œæœç´¢
            performSearch('å¯†ç æç¤º');

            // ç”Ÿæˆç›¸å…³æœç´¢
            generateRelatedSearches();

            // ä¸ºæœç´¢æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬
            searchButton.addEventListener('click', function () {
                const query = searchInput.value.trim();
                if (query) {
                    searchSuggestions.style.display = 'none';
                    performSearch(query);
                } else {
                    alert('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
                }
            });

            // ä¸ºè¾“å…¥æ¡†æ·»åŠ å›è½¦é”®æœç´¢åŠŸèƒ½
            searchInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const query = searchInput.value.trim();
                    if (query) {
                        searchSuggestions.style.display = 'none';
                        performSearch(query);
                    }
                }
            });

            // å®ç°æœç´¢å»ºè®®åŠŸèƒ½
            searchInput.addEventListener('input', function () {
                const query = searchInput.value.trim();
                showSearchSuggestions(query);
            });

            // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹éšè—å»ºè®®
            document.addEventListener('click', function (e) {
                if (!searchInput.contains(e.target) && !searchSuggestions.contains(e.target)) {
                    searchSuggestions.style.display = 'none';
                }
            });

            console.log('âœ… æœç´¢åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initSearch);
    </script>
</body>
</html>



